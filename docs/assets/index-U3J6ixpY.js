(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();const g=[{id:"legal-1",label:"特商法",href:"https://puzzle.cobake.co/",icon:"doc"},{id:"legal-2",label:"利用規約",href:"https://puzzle.cobake.co/",icon:"link"},{id:"legal-3",label:"プライバシー",href:"https://puzzle.cobake.co/",icon:"shield"}],z=7e3,S=18e3,O=5200;function C(e){const t=window.innerWidth,s=window.innerHeight,i=s*.82,n=s*.94,o=24,l=Math.max(o,t-24),r=[],c=m(o+20,l-20),u=m(i,n);for(let p=0;p<e;p++){const y=m(-80,80)+p*m(34,62),b=m(-18,18);r.push({x:x(c+y,o,l),y:x(u+b,i,n)})}return r}function D(e){return e==="doc"?'<svg viewBox="0 0 24 24"><path d="M6 2h8l4 4v16H6V2zm8 1.5V7h3.5L14 3.5zM8 11h8v1.6H8V11zm0 4h8v1.6H8V15z"/></svg>':e==="shield"?'<svg viewBox="0 0 24 24"><path d="M12 2l8 4v6c0 5.2-3.4 9.9-8 10-4.6-.1-8-4.8-8-10V6l8-4zm0 2.2L6 7v5c0 4.2 2.6 8 6 8 3.4 0 6-3.8 6-8V7l-6-2.8z"/></svg>':'<svg viewBox="0 0 24 24"><path d="M10.6 13.4a1 1 0 0 1 0-1.4l3-3a1 1 0 1 1 1.4 1.4l-3 3a1 1 0 0 1-1.4 0zM7 17a4 4 0 0 1 0-5.7l2-2A4 4 0 0 1 14.7 9a1 1 0 1 1-1.4 1.4 2 2 0 0 0-2.8 0l-2 2A2 2 0 1 0 11.3 15a1 1 0 1 1 1.4 1.4A4 4 0 0 1 7 17zm10-10a4 4 0 0 1 0 5.7l-2 2A4 4 0 0 1 9.3 15a1 1 0 1 1 1.4-1.4 2 2 0 0 0 2.8 0l2-2A2 2 0 1 0 12.7 9a1 1 0 1 1-1.4-1.4A4 4 0 0 1 17 7z"/></svg>'}function H(e){const t=document.createElement("a");return t.className="legal-item",t.href=e.href,t.target="_blank",t.rel="noopener noreferrer",t.dataset.id=e.id,t.innerHTML=`
    <span class="legal-icon">${D(e.icon)}</span>
    <span class="legal-label">${e.label}</span>
  `,t}function R(e){const t=L(1,3);return[...e].sort(()=>Math.random()-.5).slice(0,t)}function V({dockEl:e}){if(!e)return;e.innerHTML="";const t=new Map;for(const a of g){const d=H(a);t.set(a.id,d),e.appendChild(d)}let s=new Set,i=null,n=0,o=null;const l=()=>{Date.now()<n||T()},r=()=>{window.addEventListener("pointerdown",l,{passive:!0}),window.addEventListener("pointermove",l,{passive:!0}),window.addEventListener("wheel",l,{passive:!0}),window.addEventListener("keydown",l)},c=()=>{i&&clearTimeout(i),o&&clearTimeout(o),i=null,o=null},u=()=>{const a=[...s],d=C(a.length);a.forEach((h,M)=>{const f=t.get(h);f&&(f.style.left=`${d[M].x}px`,f.style.top=`${d[M].y}px`,f.style.transform="translate3d(0,0,0)")})},p=(a,d)=>{const h=t.get(a);h&&(d?h.classList.add("is-visible"):h.classList.remove("is-visible"))},y=a=>{s=new Set(a);for(const d of g)p(d.id,s.has(d.id));u()},b=()=>{c();const a=()=>{if(Date.now()<n){i=setTimeout(a,900);return}const h=g.map(f=>f.id).filter(f=>!s.has(f));if(h.length===0)return;s.add(h[0]),p(h[0],!0),u(),g.every(f=>s.has(f.id))&&(n=Date.now()+O),i=setTimeout(a,L(z,S))};i=setTimeout(a,L(z,S))},T=()=>{const a=R(g);y(a.map(d=>d.id)),b()};window.addEventListener("resize",()=>{u()},{passive:!0}),r(),T()}function m(e,t){return Math.random()*(t-e)+e}function L(e,t){return Math.floor(m(e,t+1))}function x(e,t,s){return Math.max(t,Math.min(s,e))}const A=6,B=14,N=9e3,_=22e3,v=8;function P({gearEl:e}){e&&(E(e,!0),X(e),window.addEventListener("resize",()=>{E(e,!1)},{passive:!0}))}function X(e){const t=()=>{e.style.transition="transform 120ms ease",E(e,!1),setTimeout(()=>{e.style.transition=""},180),setTimeout(t,I(N,_))};setTimeout(t,I(N,_))}function E(e,t){const s=k(A,B),i=k(A,B),n=e.getBoundingClientRect(),o=window.innerWidth,l=window.innerHeight;let r=s,c=i;n.right+s>o-v&&(r=-Math.abs(s)),n.left+s<v&&(r=Math.abs(s)),n.bottom+i>l-v&&(c=-Math.abs(i)),n.top+i<v&&(c=Math.abs(i)),e.style.transform=`translate3d(${r}px, ${c}px, 0)`,t&&(e.style.opacity="0.33")}function k(e,t){const s=I(e,t);return Math.random()<.5?-s:s}function I(e,t){return Math.floor(Math.random()*(t-e+1))+e}const w={settings:{hand:"none",foot:"none",sound:"spatial",pulse:"normal",light:"off"}};function $(e,t){w.settings[e]=t,localStorage.setItem("sense_settings",JSON.stringify(w.settings))}function J(){const e=localStorage.getItem("sense_settings");e&&(w.settings=JSON.parse(e))}const F=[{key:"hand",label:"bring what you have (hand)",options:["none","stick","light","glove"]},{key:"foot",label:"bring what you have (foot)",options:["none","shoes","leather","heel","zori"]},{key:"sound",label:"sound field",options:["spatial","mono"]},{key:"pulse",label:"pulse",options:["low","normal","high"]},{key:"light",label:"light",options:["off","low"]}];function G(){J();const e=document.getElementById("settingsOverlay"),t=document.getElementById("settingsList"),s=document.getElementById("settingsClose");return t.innerHTML="",[...F].sort(()=>Math.random()-.5).forEach(n=>{const o=document.createElement("div");o.className="setting-item";const l=document.createElement("span");l.textContent=n.label;const r=document.createElement("select");r.className="setting-select",n.options.forEach(c=>{const u=document.createElement("option");u.value=c,u.textContent=c,w.settings[n.key]===c&&(u.selected=!0),r.appendChild(u)}),r.addEventListener("change",c=>{$(n.key,c.target.value)}),o.appendChild(l),o.appendChild(r),t.appendChild(o)}),s.onclick=()=>{e.hidden=!0},e}function W(){V({dockEl:document.getElementById("legalDock")}),P({gearEl:document.getElementById("gearBtn")});const e=G();e.hidden=!0,document.getElementById("gearBtn").addEventListener("click",()=>{e.hidden=!1})}W();
